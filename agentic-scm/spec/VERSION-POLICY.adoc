// SPDX-License-Identifier: MPL-2.0-or-later
// SPDX-FileCopyrightText: 2026 Jonathan D.A. Jewell
= AGENTIC Format Version Policy
:doctype: article
:toc: left
:toclevels: 3
:sectnums:
:icons: font

== Overview

This document defines the versioning policy for the AGENTIC.scm format specification.
The policy ensures backward compatibility, clear migration paths, and predictable
evolution of the specification.

== Versioning Scheme

=== Semantic Versioning

The AGENTIC specification follows https://semver.org/[Semantic Versioning 2.0.0]:

[source]
----
MAJOR.MINOR.PATCH[-PRERELEASE][+BUILD]
----

==== Version Components

MAJOR::
  Incremented for incompatible changes that break existing parsers or semantics.
  Existing AGENTIC files may require migration.

MINOR::
  Incremented for backward-compatible additions. New optional features, sections,
  or gate modes. Existing files remain valid.

PATCH::
  Incremented for backward-compatible clarifications, typo fixes, or documentation
  improvements. No functional changes.

==== Pre-release Versions

Pre-release versions use the following suffixes:

* `-draft.N` - Working draft (unstable, may change significantly)
* `-alpha.N` - Feature complete but untested
* `-beta.N` - Feature frozen, undergoing testing
* `-rc.N` - Release candidate, final validation

=== Current Version

[cols="1,2"]
|===
|Specification Version |0.1.0-draft.1
|ABNF Grammar Version |0.1.0
|JSON Schema Version |0.1.0
|===

== Compatibility Guarantees

=== Forward Compatibility

Newer parsers MUST be able to read files created for older minor/patch versions
of the same major version.

=== Backward Compatibility

Within a major version:

* New optional sections MAY be added
* New enum values MAY be added to gate modes
* New optional properties MAY be added to existing sections
* Existing properties MUST NOT be removed or renamed
* Existing property types MUST NOT change

=== Breaking Changes

The following require a MAJOR version increment:

* Removing or renaming required properties
* Changing property types
* Changing the meaning of existing gate modes
* Removing supported gate modes
* Changing the module declaration syntax
* Altering the execution pipeline position

== Migration Policy

=== Version Detection

AGENTIC files SHOULD include version metadata:

[source,scheme]
----
(define-module (project agentic)
  #:version "0.1.0"
  #:export (gating-policies ...))
----

Parsers SHOULD detect version from:

1. Explicit `#:version` declaration
2. Feature detection (presence of version-specific constructs)
3. Default to earliest supported version

=== Migration Guides

For each MAJOR version increment:

1. A migration guide MUST be published
2. Automated migration tooling SHOULD be provided
3. Deprecation warnings MUST be issued for at least one minor release

=== Deprecation Process

. **Announcement**: Feature marked deprecated in minor release
. **Warning Period**: Minimum 2 minor releases or 6 months
. **Removal**: Feature removed in next major release

== Schema Evolution

=== ABNF Grammar

The ABNF grammar version MUST match the specification version (MAJOR.MINOR).
PATCH changes to grammar are permitted for clarification only.

Grammar changes follow the same compatibility rules as the specification.

=== JSON Schema

The JSON Schema uses JSON Schema draft-2020-12 and follows these rules:

* Schema `$id` includes the major version: `.../v1/agentic.schema.json`
* `additionalProperties: false` ensures forward validation failures
* New optional properties use default values for backward compatibility

== Release Process

=== Draft Releases

. Working drafts may be published at any time
. Draft versions are not guaranteed stable
. Breaking changes allowed between drafts

=== Stable Releases

. All tests must pass
. ABNF grammar validated against examples
. JSON Schema validated against test cases
. Documentation complete and reviewed
. Changelog updated
. Git tag created: `v{VERSION}`

=== Long-Term Support

* Each MAJOR version receives security fixes for 2 years
* Critical bug fixes for 1 year after next major release
* LTS versions explicitly marked in release notes

== Conformance Levels

=== AGENTIC-Core

Minimum conformance level:

* Parse `gating-policies` section
* Recognize all gate modes
* Enforce basic gating logic

=== AGENTIC-Full

Full conformance level:

* All AGENTIC-Core features
* Parse all five sections
* Entropy budget tracking
* Risk threshold classification
* Override path validation
* Decision recording

=== AGENTIC-Extended

Extended conformance for advanced implementations:

* All AGENTIC-Full features
* Custom gate modes
* Custom section extensions
* Integration with META.scm
* Integration with NEUROSYM.scm

== Extension Mechanism

=== Vendor Extensions

Custom sections may be added using the `x-` prefix:

[source,scheme]
----
(define x-vendor-custom
  '((custom-property . "value")))
----

Parsers MUST ignore unrecognized `x-` prefixed sections.

=== Experimental Features

Experimental features use the `experimental-` prefix:

[source,scheme]
----
(define experimental-feature
  '((enabled . #t)))
----

Experimental features may change or be removed in any release.

== References

* https://semver.org/[Semantic Versioning 2.0.0]
* https://datatracker.ietf.org/doc/html/rfc5234[RFC 5234 - ABNF]
* https://json-schema.org/specification[JSON Schema]
