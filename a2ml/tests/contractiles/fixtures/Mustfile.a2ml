# Mustfile (A2ML Example)

@abstract:
A declarative state contract describing what must be true.
@end

@requires:
- section: Parameters
- section: Checks
@end

## Parameters

- gateway_port: 8080
- schema_version: v0.0.1

## Checks

### policy-config-valid
- description: config/policy.yaml must be valid
- run: just validate-policy

### policy-nickel-compiles
- description: policy/policy.ncl must compile
- run: just compile-nickel

### gateway-exposes-port
- description: gateway must expose port 8080
- run: ss -lnt | rg ":8080"

### logs-are-json
- description: logs must be JSON
- run: rg --files -g "*.json" logs | xargs -r jq -e .

### schema-version-matches
- description: schema must match v0.0.1
- run: rg -n "v0.0.1" schema
