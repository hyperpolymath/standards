<?xml version="1.0" encoding="utf-8"?>
<!-- AXEL Firewall Zone Configuration -->
<zone target="DROP">
  <short>AXEL</short>
  <description>AXEL Protocol (Access eXplicit Enforcement & Labeling) - IPv6-only zone for age-restricted content</description>

  <!-- Allow AXEL service -->
  <service name="axel"/>

  <!-- Allow HTTP/HTTPS for attestation endpoints -->
  <service name="http"/>
  <service name="https"/>

  <!-- IPv6 rules: Accept traffic from attested prefixes -->
  <rule family="ipv6">
    <source address="2001:db8::/32"/>
    <accept/>
  </rule>

  <!-- Additional authorized prefixes (example: Cloudflare IPv6) -->
  <rule family="ipv6">
    <source address="2606:4700::/32"/>
    <accept/>
  </rule>

  <!-- IPv4 rules: Reject with informative message -->
  <rule family="ipv4">
    <reject type="icmp-host-prohibited">
      <message>AXEL requires IPv6. Please upgrade your network.</message>
    </reject>
  </rule>

  <!-- Rate limiting for testing mode -->
  <rule family="ipv6">
    <source address="::/0"/>
    <limit value="100/m"/>
    <accept/>
  </rule>

  <!-- Port definitions -->
  <port protocol="tcp" port="459"/>
  <port protocol="udp" port="459"/>
</zone>
