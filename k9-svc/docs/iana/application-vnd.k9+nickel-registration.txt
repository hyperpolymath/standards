IANA Media Type Registration: application/vnd.k9+nickel
===========================================================

This is the formal registration template for the K9 contractile media type with IANA.

Submission Date: 2026-01-30
Submitted By: Jonathan D.A. Jewell <jonathan.jewell@open.ac.uk>

---

Type name:
  application

Subtype name:
  vnd.k9+nickel

Required parameters:
  None

Optional parameters:
  security-level
    Indicates the K9 security level for this contractile.
    Values: "kennel", "yard", "hunt"
    Default: "kennel"

  validation-mode
    Indicates whether the contractile has been validated.
    Values: "validated", "unvalidated"
    Default: "unvalidated"

Encoding considerations:
  text

  K9 contractiles are UTF-8 encoded Nickel programs with specific structural
  requirements. They MUST use LF (U+000A) line endings but MAY be transmitted
  with CR+LF (U+000D U+000A) which MUST be normalized to LF on parsing.

Security considerations:
  K9 contractiles are executable Nickel programs that define infrastructure
  automation, deployment workflows, and system configurations. They pose
  significant security risks if executed without proper validation.

  **CRITICAL:** K9 contractiles MUST NOT be executed without:
  1. Cryptographic signature verification (Ed25519)
  2. Security level validation (kennel/yard/hunt boundaries)
  3. Sandbox isolation appropriate to security level
  4. User explicit consent for execution

  Security levels (increasing privilege):

  - **Kennel** (lowest privilege):
    - Read-only operations
    - Local file system queries (no writes)
    - Safe commands only (ls, cat, stat, etc.)
    - No network access
    - No process spawning
    - Sandbox: Strictly isolated, no side effects

  - **Yard** (moderate privilege):
    - File writes to designated directories only
    - Network access to allowlisted hosts
    - Process spawning with resource limits
    - Git operations (clone, pull, commit, push)
    - Package manager operations (install, update)
    - Sandbox: Capability-based, explicit grants

  - **Hunt** (full privilege):
    - Unrestricted file system access
    - Unrestricted network access
    - Unrestricted process spawning
    - System administration operations
    - **REQUIRES:** Cryptographic signature + user consent
    - Sandbox: Minimal, relies on OS-level protections

  Signature verification:
  - K9 contractiles SHOULD include Ed25519 signatures in metadata
  - Implementations MUST verify signatures before execution at yard/hunt levels
  - Unsigned contractiles MAY execute at kennel level only (read-only)
  - Signature verification MUST check:
    - Signature validity against public key
    - Timestamp within acceptable range (prevents replay)
    - Public key trust chain (if applicable)

  Privacy considerations:
  - K9 contractiles may access sensitive system information
  - Implementations SHOULD log all contractile executions
  - Audit logs SHOULD include: contractile hash, security level, timestamp, user
  - Implementations SHOULD provide mechanisms to review contractile actions
    before execution (dry-run mode)

  Integrity considerations:
  - K9 contractiles MUST be validated against schema before execution
  - Schema validation ensures contractile structure matches K9 standard
  - Implementations SHOULD compute and store contractile hashes
  - Implementations SHOULD detect and prevent contractile tampering

  Execution environment:
  - K9 contractiles MUST execute in a Nickel runtime environment
  - Implementations MUST enforce security boundaries at runtime
  - Implementations SHOULD provide resource limits (CPU, memory, time)
  - Implementations MUST provide termination mechanisms (timeout, kill)

  See security documentation:
  https://github.com/hyperpolymath/k9-svc/blob/main/docs/SECURITY.md
  https://github.com/hyperpolymath/k9-svc/blob/main/docs/THREAT-MODEL.md

Interoperability considerations:
  K9 contractiles are valid Nickel programs with additional structural
  requirements defined by the K9 standard.

  Base language:
  - Nickel programming language (https://nickel-lang.org)
  - K9 contractiles MUST be valid Nickel syntax
  - K9 contractiles MUST conform to K9 schema (Contract type)

  Required structure (must-just-nickel triad):
  1. **must** (Bash) - System validation (ls, stat, grep, etc.)
     - MUST be idempotent
     - MUST NOT modify system state
     - MUST return exit code 0 (satisfied) or non-zero (not satisfied)

  2. **just** (Justfile/make) - Execution recipes
     - Defines tasks to bring system to desired state
     - MAY modify system state
     - MUST be idempotent (safe to re-run)

  3. **nickel** (Nickel contract) - Configuration schema
     - Defines configuration structure
     - Enforces type constraints
     - Provides default values

  Compatibility:
  - K9 contractiles are backward compatible within major versions
  - Breaking changes increment major version (K9 v2.x.x)
  - Implementations SHOULD support contractile version detection
  - Implementations MAY reject contractiles with unsupported versions

  Cross-platform:
  - K9 contractiles target POSIX-compatible systems (Linux, macOS, BSD)
  - Windows support via WSL2 or MSYS2
  - Implementations SHOULD detect platform and adjust behavior
  - Contractiles MAY include platform-specific logic

  Interop with other tools:
  - K9 contractiles integrate with: Git, Docker, Kubernetes, Terraform
  - K9 contractiles MAY call external tools via recipes
  - External tool dependencies MUST be declared in metadata

Published specification:
  The K9 specification is published at:
  https://github.com/hyperpolymath/k9-svc/blob/main/docs/SPECIFICATION.md

  Additional documentation:
  - Schema: https://github.com/hyperpolymath/k9-svc/blob/main/schema.ncl
  - Examples: https://github.com/hyperpolymath/k9-svc/tree/main/examples
  - Security: https://github.com/hyperpolymath/k9-svc/blob/main/docs/SECURITY.md

Applications which use this media type:
  - K9 contractile validators and executors (k9-scan, k9-validate)
  - Infrastructure-as-code automation systems
  - CI/CD pipelines with declarative workflows
  - Configuration management systems (Puppet/Ansible replacement)
  - GitOps workflows with attested deployments
  - System provisioning and bootstrapping tools

  Reference implementation:
  https://github.com/hyperpolymath/k9-svc

Fragment identifier considerations:
  Fragment identifiers for K9 contractiles refer to recipe names within
  the justfile.

  Syntax:
    #<recipe-name>

  Where <recipe-name> is a valid Justfile recipe identifier.

  Examples:
    - #install - References the "install" recipe
    - #deploy - References the "deploy" recipe
    - #rollback - References the "rollback" recipe

  Resolution:
    1. Fragment MUST match a recipe name in the justfile section
    2. If no match, execution SHOULD fail with error
    3. Fragment MAY be used to execute specific recipe only

Restrictions on usage:
  K9 contractiles MUST NOT be executed in production environments without:
  - Cryptographic signature verification
  - Security level appropriate sandboxing
  - Audit logging enabled
  - User consent (for hunt-level operations)

Additional information:

  Deprecated alias names for this type:
    None

  Magic number(s):
    None. K9 contractiles are identified by:
    - File extension: .k9.ncl
    - Content detection: Presence of K9 schema conformance
      (Contract type, must/just/nickel structure)
    - Shebang: #!/usr/bin/env -S nickel eval (optional)

  File extension(s):
    .k9.ncl

  Macintosh file type code(s):
    None (not applicable to modern systems)

  Object Identifier(s) or OID(s):
    None

Person & email address to contact for further information:
  Jonathan D.A. Jewell
  jonathan.jewell@open.ac.uk
  The Open University
  Milton Keynes, United Kingdom

Intended usage:
  COMMON

  K9 contractiles are intended for infrastructure automation, system
  configuration, and deployment workflows. Typical use cases include:
  - Development environment setup and provisioning
  - CI/CD pipeline definitions
  - Infrastructure deployment (servers, containers, clusters)
  - Configuration management (dotfiles, system settings)
  - Release automation and orchestration
  - Compliance verification and enforcement

Author/Change controller:
  Jonathan D.A. Jewell
  The Open University
  Email: jonathan.jewell@open.ac.uk

  The K9 specification and reference implementation are open source under
  the PMPL-1.0-or-later license. Changes to the specification are managed
  through the GitHub repository with community review.

Provisional registration: No

---

Submitter's Contact Information:

Name: Jonathan D.A. Jewell
Email: jonathan.jewell@open.ac.uk
Affiliation: The Open University
Address: Milton Keynes, MK7 6AA, United Kingdom
Phone: [Available upon request]

---

Submission Instructions:

1. Submit this registration to IANA via email:
   To: iana@iana.org
   Cc: media-types@iana.org
   Subject: Media Type Registration: application/vnd.k9+nickel

2. Include this complete template as plain text attachment

3. IANA will review and may request clarifications

4. Upon approval, IANA will publish at:
   https://www.iana.org/assignments/media-types/application/vnd.k9+nickel

---

References:

[1] RFC 6838 - Media Type Specifications and Registration Procedures
    https://www.rfc-editor.org/rfc/rfc6838.html

[2] K9 Specification
    https://github.com/hyperpolymath/k9-svc/blob/main/docs/SPECIFICATION.md

[3] K9 Security Documentation
    https://github.com/hyperpolymath/k9-svc/blob/main/docs/SECURITY.md

[4] Nickel Language Specification
    https://nickel-lang.org/user-manual/syntax

---

Change Log:

2026-01-30: Initial registration template created
