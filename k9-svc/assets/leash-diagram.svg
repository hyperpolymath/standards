<?xml version="1.0" encoding="UTF-8"?>
<!-- SPDX-License-Identifier: AGPL-3.0-or-later -->
<!-- leash-diagram.svg - K9 Leash Security Model -->
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 700 450">
  <defs>
    <linearGradient id="kennelGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#4caf50;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#2e7d32;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="yardGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#ff9800;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#e65100;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="huntGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#f44336;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#b71c1c;stop-opacity:1" />
    </linearGradient>
    <filter id="glow" x="-50%" y="-50%" width="200%" height="200%">
      <feGaussianBlur stdDeviation="2" result="blur"/>
      <feMerge>
        <feMergeNode in="blur"/>
        <feMergeNode in="SourceGraphic"/>
      </feMerge>
    </filter>
  </defs>

  <!-- Background -->
  <rect width="700" height="450" fill="#1a1a2e"/>

  <!-- Title -->
  <text x="350" y="35" text-anchor="middle" fill="#ffffff" font-family="system-ui, sans-serif" font-size="22" font-weight="bold">K9 Leash Security Model</text>
  <text x="350" y="55" text-anchor="middle" fill="#888888" font-family="system-ui, sans-serif" font-size="12">Progressive trust levels for component execution</text>

  <!-- Kennel Level -->
  <g transform="translate(50, 80)">
    <rect width="180" height="320" rx="10" fill="url(#kennelGrad)" opacity="0.2" stroke="#4caf50" stroke-width="2"/>
    <rect width="180" height="50" rx="10" ry="0" fill="url(#kennelGrad)"/>
    <text x="90" y="32" text-anchor="middle" fill="#ffffff" font-family="system-ui, sans-serif" font-size="18" font-weight="bold">'Kennel</text>

    <!-- Capabilities -->
    <text x="15" y="75" fill="#4caf50" font-family="system-ui, sans-serif" font-size="12" font-weight="bold">SAFE - Pure Data</text>

    <text x="15" y="100" fill="#81c784" font-family="system-ui, sans-serif" font-size="11">Allowed:</text>
    <text x="25" y="118" fill="#a5d6a7" font-family="monospace" font-size="10">+ Read static data</text>
    <text x="25" y="133" fill="#a5d6a7" font-family="monospace" font-size="10">+ JSON/TOML parsing</text>
    <text x="25" y="148" fill="#a5d6a7" font-family="monospace" font-size="10">+ Magic number check</text>

    <text x="15" y="175" fill="#ef9a9a" font-family="system-ui, sans-serif" font-size="11">Denied:</text>
    <text x="25" y="193" fill="#ffcdd2" font-family="monospace" font-size="10">- Nickel evaluation</text>
    <text x="25" y="208" fill="#ffcdd2" font-family="monospace" font-size="10">- Just recipes</text>
    <text x="25" y="223" fill="#ffcdd2" font-family="monospace" font-size="10">- Network access</text>
    <text x="25" y="238" fill="#ffcdd2" font-family="monospace" font-size="10">- Filesystem write</text>
    <text x="25" y="253" fill="#ffcdd2" font-family="monospace" font-size="10">- Subprocess exec</text>

    <text x="15" y="285" fill="#888888" font-family="system-ui, sans-serif" font-size="10">File: .k9</text>
    <text x="15" y="300" fill="#888888" font-family="system-ui, sans-serif" font-size="10">Signature: Not required</text>
  </g>

  <!-- Yard Level -->
  <g transform="translate(260, 80)">
    <rect width="180" height="320" rx="10" fill="url(#yardGrad)" opacity="0.2" stroke="#ff9800" stroke-width="2"/>
    <rect width="180" height="50" rx="10" ry="0" fill="url(#yardGrad)"/>
    <text x="90" y="32" text-anchor="middle" fill="#ffffff" font-family="system-ui, sans-serif" font-size="18" font-weight="bold">'Yard</text>

    <!-- Capabilities -->
    <text x="15" y="75" fill="#ff9800" font-family="system-ui, sans-serif" font-size="12" font-weight="bold">SANDBOXED - Nickel Only</text>

    <text x="15" y="100" fill="#ffb74d" font-family="system-ui, sans-serif" font-size="11">Allowed:</text>
    <text x="25" y="118" fill="#ffe0b2" font-family="monospace" font-size="10">+ All Kennel capabilities</text>
    <text x="25" y="133" fill="#ffe0b2" font-family="monospace" font-size="10">+ Nickel evaluation</text>
    <text x="25" y="148" fill="#ffe0b2" font-family="monospace" font-size="10">+ Type contracts</text>
    <text x="25" y="163" fill="#ffe0b2" font-family="monospace" font-size="10">+ Config validation</text>

    <text x="15" y="190" fill="#ef9a9a" font-family="system-ui, sans-serif" font-size="11">Denied:</text>
    <text x="25" y="208" fill="#ffcdd2" font-family="monospace" font-size="10">- Just recipes</text>
    <text x="25" y="223" fill="#ffcdd2" font-family="monospace" font-size="10">- Network access</text>
    <text x="25" y="238" fill="#ffcdd2" font-family="monospace" font-size="10">- Filesystem write</text>
    <text x="25" y="253" fill="#ffcdd2" font-family="monospace" font-size="10">- Subprocess exec</text>

    <text x="15" y="285" fill="#888888" font-family="system-ui, sans-serif" font-size="10">File: .k9.ncl</text>
    <text x="15" y="300" fill="#888888" font-family="system-ui, sans-serif" font-size="10">Signature: Not required</text>
  </g>

  <!-- Hunt Level -->
  <g transform="translate(470, 80)">
    <rect width="180" height="320" rx="10" fill="url(#huntGrad)" opacity="0.2" stroke="#f44336" stroke-width="2"/>
    <rect width="180" height="50" rx="10" ry="0" fill="url(#huntGrad)"/>
    <text x="90" y="32" text-anchor="middle" fill="#ffffff" font-family="system-ui, sans-serif" font-size="18" font-weight="bold">'Hunt</text>

    <!-- Warning icon -->
    <text x="160" y="32" fill="#ffeb3b" font-family="system-ui, sans-serif" font-size="16">&#x26A0;</text>

    <!-- Capabilities -->
    <text x="15" y="75" fill="#f44336" font-family="system-ui, sans-serif" font-size="12" font-weight="bold">FULL EXECUTION</text>

    <text x="15" y="100" fill="#e57373" font-family="system-ui, sans-serif" font-size="11">Allowed:</text>
    <text x="25" y="118" fill="#ffcdd2" font-family="monospace" font-size="10">+ All Yard capabilities</text>
    <text x="25" y="133" fill="#ffcdd2" font-family="monospace" font-size="10">+ Just recipes</text>
    <text x="25" y="148" fill="#ffcdd2" font-family="monospace" font-size="10">+ Network access</text>
    <text x="25" y="163" fill="#ffcdd2" font-family="monospace" font-size="10">+ Filesystem write</text>
    <text x="25" y="178" fill="#ffcdd2" font-family="monospace" font-size="10">+ Subprocess exec</text>
    <text x="25" y="193" fill="#ffcdd2" font-family="monospace" font-size="10">+ System modification</text>

    <text x="15" y="225" fill="#ffeb3b" font-family="system-ui, sans-serif" font-size="11" font-weight="bold">Requirements:</text>
    <text x="25" y="243" fill="#fff9c4" font-family="monospace" font-size="10">! Ed25519 signature</text>
    <text x="25" y="258" fill="#fff9c4" font-family="monospace" font-size="10">! Trusted public key</text>
    <text x="25" y="273" fill="#fff9c4" font-family="monospace" font-size="10">! User authorization</text>

    <text x="15" y="300" fill="#888888" font-family="system-ui, sans-serif" font-size="10">File: .k9.ncl (hunt_authorized)</text>
  </g>

  <!-- Arrows showing progression -->
  <g filter="url(#glow)">
    <path d="M240 240 L250 240" stroke="#ffffff" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
    <polygon points="255,235 265,240 255,245" fill="#ffffff"/>

    <path d="M450 240 L460 240" stroke="#ffffff" stroke-width="2" fill="none"/>
    <polygon points="465,235 475,240 465,245" fill="#ffffff"/>
  </g>

  <!-- Footer -->
  <rect x="50" y="415" width="600" height="25" fill="#252540" rx="5"/>
  <text x="350" y="432" text-anchor="middle" fill="#888888" font-family="system-ui, sans-serif" font-size="11">The Leash tightens as capabilities increase. Hunt requires cryptographic proof of trust.</text>
</svg>
