// SPDX-License-Identifier: PMPL-1.0-or-later
// SPDX-FileCopyrightText: 2025 Jonathan D.A. Jewell
= ANCHOR Format Specification
:doctype: book
:toc: left
:toclevels: 4
:sectnums:
:source-highlighter: highlight.js
:icons: font

[.text-center]
*Internet-Draft Style Specification* +
*Version 0.1.0-draft.1* +
*January 2026*

== Abstract

This document specifies the ANCHOR.scm format, a Scheme-based syntax for
encoding project recalibration and realignment directives. ANCHOR files are
intervention documents dropped into repositories when AI agents or projects
have drifted from their intended path. They provide authoritative instructions
for scope correction, direction changes, and alignment verification.

== Status of This Memo

This document specifies an experimental protocol for the Internet community.
This is a contribution to the RFC series, independently of any other RFC stream.
Discussion and suggestions for improvement are requested.

== Copyright Notice

Copyright (c) 2025-2026 Jonathan D.A. Jewell. AGPL-3.0-or-later.

== Introduction

=== Purpose

ANCHOR.scm addresses the need for authoritative intervention when:

1. **Scope Drift** - Project or AI agent has expanded beyond intended scope
2. **Direction Change** - Strategic pivot requires explicit realignment
3. **Stock-Taking** - Periodic review and verification of alignment
4. **Course Correction** - Explicit override of accumulated context

=== Design Goals

Authoritative::
  ANCHOR provides superintendent-level authority for project realignment

Temporal::
  Each ANCHOR is dated and supersedes prior accumulated context

Explicit::
  Instructions are unambiguous and machine-readable

Traceable::
  Authority chain and decision rationale are documented

=== Relationship to Other Specifications

[cols="1,3"]
|===
|Specification |Relationship

|META.scm
|ANCHOR may direct review and update of META decisions

|STATE.scm
|ANCHOR may reset or correct STATE assumptions

|ECOSYSTEM.scm
|ANCHOR may redefine ecosystem positioning

|AGENTIC.scm
|ANCHOR operates at higher authority than AGENTIC gating

|NEUROSYM.scm
|ANCHOR may invalidate cached semantic assumptions

|PLAYBOOK.scm
|ANCHOR may halt, revise, or replace active playbooks
|===

== Terminology

=== Key Words

The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD",
"SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and "OPTIONAL" in this
document are to be interpreted as described in BCP 14 (RFC 2119, RFC 8174).

=== Definitions

ANCHOR File::
  A file with `.scm` extension containing recalibration directives in the
  format specified by this document. Named `ANCHOR.scm` or
  `ANCHOR-[purpose]-[date].scm`.

Superintendent::
  The authority responsible for project direction - may be human, corporate,
  or algorithmic. Has power to issue ANCHOR directives.

Intervention::
  An authoritative action to correct project trajectory.

Realignment::
  The process of bringing project state into conformance with ANCHOR directives.

== File Structure

=== Overview

An ANCHOR file consists of:

1. **Header Comments** - License, purpose, and authority declaration
2. **Module Declaration** - Scheme module definition
3. **Authority Section** - Who issued this ANCHOR and when
4. **Purpose Section** - Why this intervention is needed
5. **Directives Section** - Specific instructions for realignment
6. **Verification Section** - How to confirm realignment success

=== Header Comments

ANCHOR files MUST begin with SPDX license headers and authority declaration:

[source,scheme]
----
;; SPDX-License-Identifier: PMPL-1.0-or-later
;; SPDX-FileCopyrightText: 2026 Project Superintendent

;;; ANCHOR.scm â€” Project Recalibration
;;; project-name
;;; Purpose: [brief purpose]
;;; Date: [ISO-8601 date]
;;; Authority: [superintendent identifier]
----

=== Module Declaration

[source,scheme]
----
(define-module (project-name anchor)
  #:export (authority
            purpose
            directives
            scm-review
            verification))
----

== Core Sections

=== Authority (`authority`)

==== Purpose

Establishes who issued this ANCHOR and their authorization.

==== Structure

[source,scheme]
----
(define authority
  '((superintendent
     (name . "Jonathan Jewell")
     (role . "Project Owner")
     (contact . "email@example.com"))
    (issued
     (date . "2026-01-03")
     (expires . "2026-02-03")
     (supersedes . #f))
    (authorization
     (level . "full")
     (scope . "all-scm-files")
     (rationale . "Quarterly alignment review"))))
----

==== Authority Levels

* `full` - May modify any SCM file or project direction
* `scoped` - May only modify specified areas
* `advisory` - Recommendations only, not mandatory

=== Purpose (`purpose`)

==== Purpose

Explains why this intervention is needed.

==== Structure

[source,scheme]
----
(define purpose
  '((type . "scope-arrest")
    (summary . "Project scope has expanded beyond original charter")
    (symptoms
     ("Feature creep in last 3 sprints"
      "Test coverage declining"
      "Technical debt accumulating"))
    (desired-outcome
     ("Return to core value proposition"
      "Stabilize architecture before new features"
      "Clear technical debt backlog"))))
----

==== Purpose Types

* `scope-arrest` - Stop scope expansion
* `direction-change` - Strategic pivot
* `stock-taking` - Periodic alignment review
* `emergency-halt` - Critical issue requires stop
* `course-correction` - Minor trajectory adjustment

=== Directives (`directives`)

==== Purpose

Specific instructions for what must happen.

==== Structure

[source,scheme]
----
(define directives
  '((immediate
     ((action . "halt-new-features")
      (description . "No new feature work until backlog cleared")
      (priority . "critical")
      (deadline . "2026-01-05"))
     ((action . "review-meta")
      (description . "Review and update META.scm architecture decisions")
      (priority . "high")
      (deadline . "2026-01-10")))

    (this-week
     ((action . "update-state")
      (description . "Correct STATE.scm to reflect actual progress")
      (priority . "high"))
     ((action . "clear-debt")
      (description . "Address top 5 technical debt items")
      (priority . "medium")))

    (this-month
     ((action . "align-ecosystem")
      (description . "Verify ECOSYSTEM.scm relationships are accurate")
      (priority . "medium"))
     ((action . "resume-features")
      (description . "Resume feature work with new constraints")
      (priority . "normal")))))
----

==== Directive Priorities

* `critical` - Must be done immediately, blocks all other work
* `high` - Should be done within deadline
* `medium` - Important but not blocking
* `normal` - Standard priority
* `low` - When time permits

=== SCM Review (`scm-review`)

==== Purpose

Specifies which SCM files need review and what to check.

==== Structure

[source,scheme]
----
(define scm-review
  '((meta
     (review-required . #t)
     (focus-areas . ("architecture-decisions" "development-practices"))
     (expected-updates . ("adr-015 may need revision")))

    (state
     (review-required . #t)
     (focus-areas . ("current-position" "blockers-and-issues"))
     (expected-updates . ("completion percentages" "milestone status")))

    (ecosystem
     (review-required . #f)
     (focus-areas . ())
     (expected-updates . ()))

    (agentic
     (review-required . #t)
     (focus-areas . ("entropy-budgets"))
     (expected-updates . ("may need stricter gating")))

    (neurosym
     (review-required . #f)
     (focus-areas . ())
     (expected-updates . ()))

    (playbook
     (review-required . #t)
     (focus-areas . ("procedures"))
     (expected-updates . ("deployment procedures need update")))))
----

=== Verification (`verification`)

==== Purpose

Defines how to confirm realignment was successful.

==== Structure

[source,scheme]
----
(define verification
  '((success-criteria
     ((criterion . "scope-contained")
      (measure . "No new features in backlog"))
     ((criterion . "state-accurate")
      (measure . "STATE.scm matches reality"))
     ((criterion . "debt-addressed")
      (measure . "Top 5 debt items resolved")))

    (verification-method
     (type . "checklist")
     (reviewer . "superintendent")
     (deadline . "2026-01-15"))

    (on-success
     (action . "archive-anchor")
     (notification . "superintendent"))

    (on-failure
     (action . "escalate")
     (notification . ("superintendent" "stakeholders")))))
----

== Execution Protocol

=== ANCHOR Discovery

AI agents SHOULD check for ANCHOR files:

1. At session start
2. When directed to root or `.machine_readable` directory
3. After receiving "anchor" or "realign" commands

=== ANCHOR Processing

When an ANCHOR file is found:

1. Read and parse the authority section
2. Verify authority is current (not expired)
3. Acknowledge the purpose to the user
4. Execute directives in priority order
5. Perform SCM review as specified
6. Report verification status

=== Supersession

A new ANCHOR file supersedes:

* Any prior ANCHOR files (if `supersedes` is set)
* Accumulated context that conflicts with directives
* Cached assumptions about project state

== File Naming

=== Standard Names

* `ANCHOR.scm` - Current active anchor (only one at a time)
* `ANCHOR-[purpose]-[YYYY-MM-DD].scm` - Dated anchor for archives

=== Examples

* `ANCHOR.scm` - Current intervention
* `ANCHOR-scope-arrest-2026-01-03.scm` - Archived intervention
* `ANCHOR-direction-change-2025-12-15.scm` - Historical pivot

== Security Considerations

=== Authority Verification

Implementations SHOULD verify ANCHOR authority against known superintendents.

=== Expiration

ANCHOR files SHOULD have expiration dates. Expired ANCHORs SHOULD be treated
as advisory only.

=== Audit Trail

All ANCHOR processing MUST be logged for security review.

== IANA Considerations

=== Media Type Registration

* **Type name**: application
* **Subtype name**: anchor+scheme
* **Required parameters**: None
* **Optional parameters**: charset (default UTF-8), version
* **Encoding considerations**: UTF-8 text
* **Security considerations**: See Security Considerations section
* **Published specification**: This document

== Conformance

An implementation is ANCHOR-conformant if:

* ANCHOR files are discovered at appropriate times
* Authority is validated before processing
* Directives are executed in priority order
* SCM review is performed as specified
* Verification criteria are checked
* All processing is logged
