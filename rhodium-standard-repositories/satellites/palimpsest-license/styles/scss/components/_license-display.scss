// components/_license-display.scss
// License display widget styles for Palimpsest License

@use '../variables' as *;
@use '../mixins' as *;
@use '../functions' as *;

// ============================================================================
// License Display Container
// ============================================================================

.license-display {
  @include card($licence-display-padding);
  margin: $spacing-xl 0;
  border-width: $licence-display-border-width;
  border-color: var(--colour-accent);

  &__header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: $spacing-lg;
    padding-bottom: $spacing-md;
    border-bottom: $border-width-thin solid var(--colour-border);

    h2, h3 {
      margin: 0;
      display: flex;
      align-items: center;
      gap: $spacing-sm;
    }
  }

  &__title {
    font-size: $font-size-2xl;
    font-weight: $font-weight-semibold;
    color: var(--colour-text);
  }

  &__version {
    display: inline-block;
    padding: $spacing-xs $spacing-sm;
    background-color: var(--colour-surface);
    border: $border-width-thin solid var(--colour-border);
    border-radius: $border-radius-sm;
    font-size: $font-size-sm;
    font-weight: $font-weight-medium;
  }

  &__body {
    margin-bottom: $spacing-lg;
  }

  &__footer {
    display: flex;
    align-items: center;
    justify-content: space-between;
    flex-wrap: wrap;
    gap: $spacing-md;
    margin-top: $spacing-lg;
    padding-top: $spacing-md;
    border-top: $border-width-thin solid var(--colour-border);
    font-size: $font-size-sm;

    @include breakpoint-down(md) {
      flex-direction: column;
      align-items: flex-start;
    }
  }

  // Compact variant
  &--compact {
    padding: $spacing-md;

    .license-display__header {
      margin-bottom: $spacing-md;
    }

    .license-display__title {
      font-size: $font-size-xl;
    }
  }

  // Minimal variant (for embedding)
  &--minimal {
    padding: $spacing-md;
    border: none;
    box-shadow: none;
    background-color: transparent;

    .license-display__header {
      border-bottom: none;
      margin-bottom: $spacing-sm;
    }
  }
}

// ============================================================================
// License Text
// ============================================================================

.license-text {
  line-height: $line-height-relaxed;
  color: var(--colour-text);

  p {
    margin-bottom: $spacing-md;
  }

  // Highlighted clauses
  &__clause {
    margin: $spacing-lg 0;
    padding: $spacing-md;
    background-color: var(--colour-surface);
    border-left: $border-width-thick solid var(--colour-accent);
    border-radius: $border-radius-sm;

    &-number {
      font-weight: $font-weight-semibold;
      color: var(--colour-accent);
      margin-right: $spacing-sm;
    }

    &-title {
      font-weight: $font-weight-semibold;
      margin-bottom: $spacing-sm;
    }

    // Important clauses
    &--important {
      border-left-color: $colour-warning;
      background-color: colour-opacity($colour-warning, 0.05);
    }

    // Critical clauses
    &--critical {
      border-left-color: $colour-error;
      background-color: colour-opacity($colour-error, 0.05);
    }
  }

  // Definitions
  &__definition {
    margin: $spacing-md 0;
    padding-left: $spacing-lg;

    dt {
      font-weight: $font-weight-semibold;
      color: var(--colour-accent);
      margin-bottom: $spacing-xs;
    }

    dd {
      margin-left: 0;
      margin-bottom: $spacing-md;
    }
  }
}

// ============================================================================
// License Actions
// ============================================================================

.license-actions {
  display: flex;
  gap: $spacing-md;
  flex-wrap: wrap;

  &__button {
    @include button-reset;
    padding: $spacing-sm $spacing-lg;
    background-color: var(--colour-accent);
    color: var(--colour-background);
    border-radius: $border-radius-md;
    font-weight: $font-weight-medium;
    text-decoration: none;
    transition: opacity $transition-speed-normal;

    @include touch-target;

    &:hover,
    &:focus {
      opacity: 0.9;
    }

    // Secondary button
    &--secondary {
      background-color: transparent;
      color: var(--colour-accent);
      border: $border-width-medium solid var(--colour-accent);
    }

    // Icon button
    &--icon {
      display: inline-flex;
      align-items: center;
      gap: $spacing-xs;
    }
  }
}

// ============================================================================
// License Summary
// ============================================================================

.license-summary {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: $spacing-md;
  margin: $spacing-lg 0;

  &__item {
    padding: $spacing-md;
    background-color: var(--colour-surface);
    border-radius: $border-radius-md;
    border: $border-width-thin solid var(--colour-border);

    &-label {
      font-size: $font-size-sm;
      font-weight: $font-weight-medium;
      color: colour-opacity(var(--colour-text), 0.7);
      margin-bottom: $spacing-xs;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    &-value {
      font-size: $font-size-lg;
      font-weight: $font-weight-semibold;
      color: var(--colour-text);
    }
  }
}

// ============================================================================
// License Permissions
// ============================================================================

.license-permissions {
  margin: $spacing-lg 0;

  &__list {
    @include list-unstyled;
    display: grid;
    gap: $spacing-sm;
  }

  &__item {
    display: flex;
    align-items: flex-start;
    gap: $spacing-sm;
    padding: $spacing-sm;
    background-color: var(--colour-surface);
    border-radius: $border-radius-sm;

    &-icon {
      flex-shrink: 0;
      width: 1.5rem;
      height: 1.5rem;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
      font-weight: $font-weight-bold;
    }

    // Allowed
    &--allowed &-icon {
      background-color: colour-opacity($colour-success, 0.1);
      color: $colour-success;

      &::before {
        content: "✓";
      }
    }

    // Restricted
    &--restricted &-icon {
      background-color: colour-opacity($colour-warning, 0.1);
      color: $colour-warning;

      &::before {
        content: "⚠";
      }
    }

    // Forbidden
    &--forbidden &-icon {
      background-color: colour-opacity($colour-error, 0.1);
      color: $colour-error;

      &::before {
        content: "✗";
      }
    }
  }
}

// ============================================================================
// License Comparison
// ============================================================================

.license-comparison {
  overflow-x: auto;
  margin: $spacing-lg 0;

  table {
    width: 100%;
    min-width: 600px;
    border-collapse: collapse;

    th {
      background-color: var(--colour-surface);
      font-weight: $font-weight-semibold;
      text-align: left;
      padding: $spacing-md;
      border: $border-width-thin solid var(--colour-border);
      position: sticky;
      top: 0;
      z-index: 1;
    }

    td {
      padding: $spacing-md;
      border: $border-width-thin solid var(--colour-border);
    }

    tr:nth-child(even) {
      background-color: colour-opacity(var(--colour-surface), 0.5);
    }
  }
}

// ============================================================================
// Bilingual License Display
// ============================================================================

.license-bilingual {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: $spacing-xl;
  margin: $spacing-lg 0;

  @include breakpoint-down(lg) {
    grid-template-columns: 1fr;
  }

  &__column {
    padding: $spacing-lg;
    border: $border-width-thin solid var(--colour-border);
    border-radius: $border-radius-md;

    &[lang="nl"] {
      border-left: $border-width-thick solid $colour-palimpsest-primary;
    }

    &[lang="en"] {
      border-left: $border-width-thick solid $colour-palimpsest-accent;
    }
  }

  &__language-label {
    display: inline-block;
    padding: $spacing-xs $spacing-sm;
    background-color: var(--colour-accent);
    color: var(--colour-background);
    border-radius: $border-radius-sm;
    font-size: $font-size-xs;
    font-weight: $font-weight-semibold;
    text-transform: uppercase;
    margin-bottom: $spacing-md;
  }
}

// ============================================================================
// Print Styles for License Display
// ============================================================================

@include print-styles {
  .license-display {
    border: $border-width-medium solid #000;
    page-break-inside: avoid;

    &__header {
      page-break-after: avoid;
    }
  }

  .license-actions {
    @include print-hidden;
  }

  .license-bilingual {
    grid-template-columns: 1fr;

    &__column {
      page-break-inside: avoid;
    }
  }
}
