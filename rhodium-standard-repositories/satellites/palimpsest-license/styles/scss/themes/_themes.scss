// themes/_themes.scss
// Theme definitions for Palimpsest License

@use '../variables' as *;
@use '../mixins' as *;

// ============================================================================
// Light Theme (Default)
// ============================================================================

@include light-mode {
  :root {
    --colour-text: #{$colour-text-light};
    --colour-background: #{$colour-background-light};
    --colour-accent: #{$colour-accent-light};
    --colour-surface: #{$colour-surface-light};
    --colour-border: #{$colour-border-light};
    --text-contrast: 21;
  }

  body {
    background-color: $colour-background-light;
    color: $colour-text-light;
  }

  a {
    color: $colour-accent-light;
  }

  .markdown-body {
    background-color: $colour-background-light;
    color: $colour-text-light;
  }

  // Table styling for light mode
  tr:nth-child(even) {
    background-color: $colour-surface-light;
  }

  th {
    background-color: $colour-surface-light;
  }

  // Code blocks
  pre,
  code {
    background-color: $colour-surface-light;
  }
}

// ============================================================================
// Dark Theme
// ============================================================================

@include dark-mode {
  :root {
    --colour-text: #{$colour-text-dark};
    --colour-background: #{$colour-background-dark};
    --colour-accent: #{$colour-accent-dark};
    --colour-surface: #{$colour-surface-dark};
    --colour-border: #{$colour-border-dark};
    --text-contrast: 12;
  }

  body {
    background-color: $colour-background-dark;
    color: $colour-text-dark;
  }

  a {
    color: $colour-accent-dark;
  }

  .markdown-body {
    background-color: $colour-background-dark;
    color: $colour-text-dark;
  }

  // Table styling for dark mode
  tr:nth-child(even) {
    background-color: $colour-surface-dark;
  }

  th {
    background-color: $colour-surface-dark;
    border-color: $colour-border-dark;
  }

  td {
    border-color: $colour-border-dark;
  }

  // Code blocks
  pre {
    background-color: $colour-surface-dark;
  }

  code {
    background-color: $colour-surface-dark;
  }

  // Adjust selection colour for dark mode
  ::selection {
    background-color: $colour-accent-dark;
    color: $colour-background-dark;
  }
}

// ============================================================================
// High Contrast Theme
// ============================================================================

@include high-contrast {
  :root {
    forced-color-adjust: auto;
  }

  body {
    forced-color-adjust: none;
  }

  a {
    color: LinkText;

    &:visited {
      color: VisitedText;
    }

    &:active {
      color: ActiveText;
    }
  }

  button {
    border: $border-width-medium solid ButtonBorder;
    background-color: ButtonFace;
    color: ButtonText;
  }

  :focus {
    outline: 2px solid Highlight;
    outline-offset: 2px;
  }

  // Ensure all borders are visible
  .card,
  .license-display,
  .metadata,
  .compliance-card {
    border: $border-width-medium solid CanvasText;
  }

  // Badges in high contrast
  .badge {
    border: $border-width-medium solid CanvasText;
  }
}

// ============================================================================
// Palimpsest Brand Theme
// ============================================================================

.theme-palimpsest {
  --colour-accent: #{$colour-palimpsest-accent};

  .license-display {
    border-color: $colour-palimpsest-primary;
  }

  .badge-version,
  .badge--accent {
    background: linear-gradient(135deg,
      $colour-palimpsest-primary,
      $colour-palimpsest-accent);
  }

  h1, h2, h3 {
    color: $colour-palimpsest-primary;
  }

  a {
    color: $colour-palimpsest-accent;

    &:hover {
      color: darken-colour($colour-palimpsest-accent, 10%);
    }
  }
}

// ============================================================================
// Minimal Theme (for embeds)
// ============================================================================

.theme-minimal {
  .license-display {
    border: none;
    box-shadow: none;
    padding: $spacing-md;
  }

  .card {
    border: none;
    box-shadow: none;
  }

  .badge {
    border: none;
  }
}

// ============================================================================
// Print Theme
// ============================================================================

@include print-styles {
  :root {
    --colour-text: #000000;
    --colour-background: #ffffff;
    --colour-accent: #000000;
    --colour-surface: #ffffff;
    --colour-border: #000000;
  }

  body {
    background-color: white !important;
    color: black !important;
    -webkit-print-color-adjust: exact;
    print-color-adjust: exact;
  }

  // Ensure proper contrast in print
  a {
    color: #000000;
    text-decoration: underline;
  }

  // Show URLs after links
  a[href]::after {
    content: " (" attr(href) ")";
    font-size: 0.8em;
    color: #666;
  }

  // Don't show URLs for anchor links
  a[href^="#"]::after,
  a[href^="javascript:"]::after {
    content: "";
  }

  // Borders in print
  .card,
  .license-display,
  .metadata,
  .compliance-card,
  table {
    border: 1px solid #000000 !important;
  }

  // Badges in print
  .badge {
    border: 1px solid #000000 !important;
    background-color: transparent !important;
    color: #000000 !important;
  }

  // Hide interactive elements
  .license-actions,
  .metadata-jsonld__copy-button,
  .compliance-checklist__item-checkbox,
  button:not(.print-visible) {
    display: none !important;
  }

  // Page breaks
  .license-display,
  .compliance-card,
  .metadata {
    page-break-inside: avoid;
  }

  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
    page-break-inside: avoid;
  }
}

// ============================================================================
// Reduced Transparency Theme
// ============================================================================

@include reduced-transparency {
  body {
    background-color: $colour-background-light;
    color: $colour-text-light;
  }

  @include dark-mode {
    body {
      background-color: $colour-background-dark;
      color: $colour-text-dark;
    }
  }

  // Remove all transparency effects
  .badge,
  .compliance-status,
  .metadata-lineage,
  .metadata-hash {
    background-color: var(--colour-surface);
    border-color: var(--colour-border);
  }
}

// ============================================================================
// Increased Contrast Theme
// ============================================================================

@media (prefers-contrast: more) {
  :root {
    --colour-accent: #{$colour-accent-light};
    --colour-border: #{$colour-text-light};
  }

  @include dark-mode {
    :root {
      --colour-accent: #{$colour-accent-dark};
      --colour-border: #{$colour-text-dark};
    }
  }

  // Increase border visibility
  .card,
  .license-display,
  .metadata,
  .compliance-card,
  .badge {
    border-width: $border-width-medium;
  }

  // Enhance focus indicators
  :focus-visible {
    outline-width: $focus-outline-width + 1px;
    outline-offset: $focus-outline-offset + 1px;
  }

  // Stronger text contrast
  body {
    font-weight: $font-weight-medium;
  }

  // More visible links
  a {
    text-decoration: underline;
    text-decoration-thickness: 2px;
  }
}

// ============================================================================
// Theme Switcher (data-theme attribute)
// ============================================================================

// Manual theme switching via data-theme attribute
[data-theme="light"] {
  --colour-text: #{$colour-text-light};
  --colour-background: #{$colour-background-light};
  --colour-accent: #{$colour-accent-light};
  --colour-surface: #{$colour-surface-light};
  --colour-border: #{$colour-border-light};

  background-color: $colour-background-light;
  color: $colour-text-light;
}

[data-theme="dark"] {
  --colour-text: #{$colour-text-dark};
  --colour-background: #{$colour-background-dark};
  --colour-accent: #{$colour-accent-dark};
  --colour-surface: #{$colour-surface-dark};
  --colour-border: #{$colour-border-dark};

  background-color: $colour-background-dark;
  color: $colour-text-dark;
}

[data-theme="palimpsest"] {
  --colour-accent: #{$colour-palimpsest-accent};

  h1, h2, h3 {
    color: $colour-palimpsest-primary;
  }

  a {
    color: $colour-palimpsest-accent;
  }
}
