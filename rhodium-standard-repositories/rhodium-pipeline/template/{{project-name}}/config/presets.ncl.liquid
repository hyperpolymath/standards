# {{ project-name }} Configuration Presets
#
# Pre-defined configurations for common scenarios.
# Import and merge with default configuration.
#
# Usage:
#   let presets = import "presets.ncl" in
#   std.record.merge default_config presets.dev

# =============================================================================
# DEVELOPMENT PRESET
# =============================================================================

let dev = {
  processing = {
    threads = 2,
    batch_size = 100,
  },

  validation = {
    level = "quick",
    strict = false,
  },

  checksum = {
    auto_verify = false,
    auto_generate = false,
  },

  logging = {
    level = "debug",
    format = "pretty",
  },
}
in

# =============================================================================
# PRODUCTION PRESET
# =============================================================================

let prod = {
  processing = {
    threads = {{ default_threads }},
    batch_size = 5000,
    buffer_size = 16777216,  # 16MB
  },

  validation = {
    level = "full",
    strict = true,
  },

  checksum = {
    auto_verify = true,
    auto_generate = true,
  },

  logging = {
    level = "warn",
    format = "json",
  },
}
in

# =============================================================================
# CI/CD PRESET
# =============================================================================

let ci = {
  output = {
    overwrite = true,
  },

  processing = {
    threads = 2,
    batch_size = 500,
  },

  validation = {
    level = "standard",
    strict = true,
  },

  checksum = {
    auto_verify = true,
    auto_generate = true,
  },

  logging = {
    level = "info",
    format = "compact",
  },
}
in

# =============================================================================
# PARANOID PRESET (Maximum validation)
# =============================================================================

let paranoid = {
  processing = {
    threads = 1,  # Deterministic
    batch_size = 100,
  },

  validation = {
    level = "paranoid",
    strict = true,
    tolerance = 0.001,
    check_proofs = true,
  },

  checksum = {
    algorithm = "shake256",
    auto_verify = true,
    auto_generate = true,
  },

  logging = {
    level = "trace",
    format = "full",
  },
}
in

# =============================================================================
# FAST PRESET (Speed over accuracy)
# =============================================================================

let fast = {
  processing = {
    algorithm = 'fast,
    threads = {{ default_threads }},
    batch_size = 10000,
    buffer_size = 33554432,  # 32MB
    streaming = true,
    mmap = true,
  },

  validation = {
    level = "skip",
  },

  checksum = {
    algorithm = "xxhash",
    auto_verify = false,
    auto_generate = false,
  },

  logging = {
    level = "error",
  },
}
in

# =============================================================================
# LOW MEMORY PRESET
# =============================================================================

let low_memory = {
  processing = {
    algorithm = 'low_memory,
    threads = 1,
    batch_size = 50,
    buffer_size = 1048576,  # 1MB
    memory_limit = 536870912,  # 512MB
    streaming = true,
    mmap = false,
  },

  validation = {
    level = "quick",
  },

  logging = {
    level = "warn",
  },
}
in

# =============================================================================
# EXPORTS
# =============================================================================

{
  dev,
  prod,
  ci,
  paranoid,
  fast,
  low_memory,

  # Aliases
  development = dev,
  production = prod,
  continuous_integration = ci,
}
