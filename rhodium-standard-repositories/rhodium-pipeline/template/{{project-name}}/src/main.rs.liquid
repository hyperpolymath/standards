//! {{ description }}
//!
//! Generated from Rhodium Pipeline Template v1.0.0
//! Methodology: Rhodium Standard Repositories (RSR)

use clap::Parser;
use color_eyre::eyre::Result;
use tracing::info;

mod cli;
mod config;
mod error;
mod pipeline;
mod checksum;
mod validation;

use cli::{Cli, Commands};

#[tokio::main]
async fn main() -> Result<()> {
    // Initialize error handling
    color_eyre::install()?;

    // Parse CLI arguments
    let cli = Cli::parse();

    // Initialize logging based on verbosity
    cli::init_logging(&cli)?;

    info!(version = env!("CARGO_PKG_VERSION"), "Starting {{ project-name }}");

    // Dispatch to appropriate command
    match cli.command {
        Commands::Run(args) => pipeline::run(args, &cli.global).await,
        Commands::Validate(args) => validation::validate(args, &cli.global).await,
        Commands::Config(args) => config::handle(args, &cli.global).await,
        Commands::Checksum(args) => checksum::handle(args, &cli.global).await,
        Commands::Completions(args) => cli::generate_completions(args),
        Commands::Manpage(args) => cli::generate_manpage(args),
    }
}
